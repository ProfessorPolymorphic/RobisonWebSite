{
  "hash": "91199e87617ee76d9778e84b8e138ef5",
  "result": {
    "markdown": "---\ntitle: \"TUTORIAL 5 - Marks and Channels\"\nauthor: \"Barrie Robison\"\ndate: \"2023-02-13\"\ncategories: [Assignment, DataViz]\nimage: \"Cthulhuscattergreen.png\"\ncode-fold: true\ncode-tools: true\ndescription: \"Trying out terrible combinations of marks and channels... for learning!\"\n---\n\n\nThis tutorial is my attempt at [Assignment 4](../A4-MarksChannels/index.qmd)!\n\n## MARKS AND CHANNELS\n\n### Expressiveness and Effectiveness\n\n#### Directions\n\n*From Munzner, 5.4.1:*\n\n[The expressiveness principle:]{.red} Visual encoding should express all of, and only, the information in the dataset attributes. Ordered data should be shown in a way that our perceptual system intrinsically senses as ordered. Conversely, unordered data should not be shown in a way that perceptually implies an ordering that does not exist.\n\n[The effectiveness principle:]{.red} The importance of the attribute should match the salience of the channel (its noticeablity). The most important attributes should be encoded with the most effective channels.\n\nUsing whatever data set you choose, create a visualization called Figure 1 that adheres to these two principles. Write a caption that explains your choices of marks and channels in these terms. Then, using the exact same data, create a visualization called Figure 2 that violates these principles in the most extreme ways you can imagine while still having the visualization be recognizibly the same as the first. Write a caption that explains your choices of marks and channels and why they are bad compared to Figure 1.\n\n#### Response\n\nI'm interested in testing the hypothesis that this season's [Vancouver Canucks](https://www.nhl.com/canucks) are a historically terrible team.  One of the key factors in this hypothesis is that this year's Canucks really, really suck at killing penalties. For this first assignment component, I'll show you what I mean with a visualization!\n\nThe data I am using was downloaded from [Moneypuck.com](https://moneypuck.com/data.htm). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.5.0 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(vroom)\n\nfiles <- fs::dir_ls(glob = \"*teams.csv\")\n\nallseasons <- vroom::vroom(files)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 1990 Columns: 107\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (5): team...1, name, team...4, position, situation\ndbl (102): season, games_played, xGoalsPercentage, corsiPercentage, fenwickP...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nallseasons$color<-\"darkblue\"\nallseasons$color[allseasons$name==\"VAN\" & allseasons$season==\"2022\"]  <- \"red\"\n  allseasons$teamseason<- paste(allseasons$name, allseasons$season)\n  \n  allseasons$HDSAR<-allseasons$highDangerShotsAgainst/allseasons$iceTime*120\n  \n  PKDATA<-allseasons[c(\"situation\", \"teamseason\", \"goalsAgainst\", \"penaltiesFor\")]\n  PKpenalties<-subset(PKDATA, situation == \"all\")\n  PKgoals<-subset(PKDATA, situation == \"4on5\")\n  PK<-PKgoals[c(\"teamseason\", \"goalsAgainst\")]\n  PK$penaltiesFor<-PKpenalties$penaltiesFor\n  PK$PKpercent<-100-(PK$goalsAgainst/PK$penaltiesFor*100)\n```\n:::\n\n\nNow that I've massaged the data, I can tell you that the 2022-2023 Vancouver Canucks penalty kill percentage is 76.9633508.\n  \n  \n\n::: {.cell}\n\n```{.r .cell-code}\n  d <- density(PK$PKpercent)\n\n# Step 3: Create an ECDF\ne <- ecdf(PK$PKpercent)\n\n# Step 4: Calculate the quantile value\nq <- quantile(PK$PKpercent, 0.01)\n\n# Step 5: Calculate the empirical cumulative probability for the quantile value\np <- e(q)\n\n# Step 6: Estimate the density value for the quantile value\nf <- approxfun(d$x, d$y)\nd_q <- f(q)\n\n# Step 7: Combine the results into a list\npercentile <- list(q = q, p = p, d = d_q)\n\n\nVAN22 <- PK$PKpercent[PK$teamseason == \"VAN 2022\"]\n\nggplot(PK, aes(x=PKpercent))+\n  geom_histogram(aes(y = ..density..), binwidth = 0.5, color = \"black\", fill=\"white\")+\n  geom_density(lwd = 1, colour = 4,\n               fill = 4, alpha = 0.25)+\n  geom_vline(xintercept = VAN22, color = \"blue\", size=1.0)+\n  geom_vline(xintercept = q, color = \"red\", size = 1, linetype=\"dotted\")+\n  xlab(\"Penalty Kill (%)\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\nℹ Please use `after_stat(density)` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThis is fine.  We know this to be true.  Their PK sucks.  But WHY is it so bad?  Bad goaltending?  Bad defense?  My theory is that their defense hangs their goaltenders out to dry.  This might be measured with the number of High Danger Shots Allowed.  Below I calculate that and then standardize it to a rate per 2 minutes (the normal duration of an NHL minor penalty).\n  \n\n::: {.cell}\n\n```{.r .cell-code}\nPKsituation<-subset(allseasons, situation == \"4on5\")\n# Step 2: Estimate the density of the data\nd <- density(PKsituation$HDSAR)\n\n# Step 3: Create an ECDF\ne <- ecdf(PKsituation$HDSAR)\n\n# Step 4: Calculate the quantile value\nq <- quantile(PKsituation$HDSAR, 0.95)\n\n# Step 5: Calculate the empirical cumulative probability for the quantile value\np <- e(q)\n\n# Step 6: Estimate the density value for the quantile value\nf <- approxfun(d$x, d$y)\nd_q <- f(q)\n\n# Step 7: Combine the results into a list\npercentile <- list(q = q, p = p, d = d_q)\n\n\nVAN22HD <- PKsituation$HDSAR[PKsituation$teamseason == \"VAN 2022\"]\n\n\n\n\n\nggplot(PKsituation, aes(x=HDSAR))+\n  geom_histogram(aes(y = ..density..), binwidth = 0.005, color = \"black\", fill=\"white\")+\n  geom_density(lwd = 1, colour = 4,\n               fill = 4, alpha = 0.25)+\n  geom_vline(xintercept = VAN22HD, color = \"blue\", size=1.0)+\n  geom_vline(xintercept = q, color = \"red\", size = 1, linetype=\"dotted\")+\n  xlab(\"High Danger Shots Allowed (rate per 2 minutes)\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n**Figure 1.**  Distribution of High Danger Shot Rate for NHL teams over the past 10 seasons.  The 2022-2023 Vancouver Canucks are shown with the dark blue line (HDSAR = 0.3220996) and the 95th percentile is shown in [red]{.red}.  \n\nIn terms of the semantics of Data Visualization, I am trying to DISCOVER the DISTRIBUTION of `High Danger Shots Allowed`, and then ANNOTATE the DISTRIBUTION with information about the current Vancouver Canucks team and their approximate percentile in the distribution.\n\nTo visualize this I am encoding a DERIVED attribute - the relative density of HDSAR as VERTICAL LENGTH of a bar (technically the MARK is a LINE) on an aligned axis.  This is a pretty powerful encoding, which is why it is very common when visualizing distributions.  In addtion, I am encoding HDSAR values themselves with HORIZONTAL POSITION.  A nice, ordered channel for a nice, ordered attribute.  The DENSITY FUNCTION is less clear to me.  I'm obviously using a line, whose vertical and horizontal position encodes the relationship between the two variables.  But the blue shaded fill?  I kind of think that is using an AREA channel and REDUNDANT ENCODING to send a stronger signal.  \n\nThe annotations of the 95th percentile and the 2022 Canucks' HDSAR are encoded with COLOR and HORIZONTAL POSITION CHANNELS, and LINES as MARKS.\n\nNow, lets mess this up!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(PKsituation, aes(x=teamseason, y=HDSAR)) +\n  geom_bar(stat=\"identity\", aes(fill=name, alpha=season)) +\n  xlab(\"NHL Team and Season\") +\n  ylab(\"High Danger Shots Allowed (rate per 2 minutes)\") +\n  ggtitle(\"Are the Vancouver Canucks Historically Bad?\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, size = 0.1),\n        legend.position = \"right\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n**Figure 2.**  Distribution of High Danger Shot Rate for NHL teams over the past 10 seasons.    \n\nHoly Crap.  What an absolute nightmate.  In terms of MARKS, I've stayed with LINES.  But the CHANNELS... wow.  The COLOR CHANNEL is used to indicate the team.  The ALPHA CHANNEL (transparency) is used to indicate season (time).  These choices create HUGE problems related to discriminability (alpha channel) and separability.  In addition, my choice to order these lines according to team and season is not at all compatible with my choice of channels.  Not to mention that the important thing - to see where the 2022 Canucks stand in terms of historical futility - is completely wrecked because the horizontal position (a strong channel) is not closely tied to the most salient Attribute (HDSAR).  Go ahead and pick out the the 2022 Canucks from this figure.... I'll wait.\n\n### [Discriminability](../L4-Marks-Channels/index.qmd#DISCRIMINABILITY)\n\nUsing whatever data set you choose (it need not be the same data used for Figures 1 and 2), create a visualization called Figure 3 that uses a magnitude channel a number of bins that facilitate discriminiability of an attribute. Write a caption that explains your choices of marks and channels in these terms. Then, using the exact same data, create a visualization called Figure 4 that uses this same channel for WAY TOO MANY BINS, violating the guidelines for discriminability. Write a caption that explains why this number of bins is bad compared to Figure 3.\n\n### [Separability](../L4-Marks-Channels/index.qmd#SEPARABILITY%20VS%20INTEGRALITY)\n\nUsing whatever data set you choose (it need not be the same data used for Figures 1-4), create a visualization called Figure 5 that uses a two or more channels to encode two or more attributes while maintainig separability. Write a caption that explains your choices of marks and channels in these terms. Then, using the exact same data, create a visualization called Figure 6 that uses channels that are integral, or at least much less separable. Write a caption that explains why choosing these channels is bad compared to Figure 5.\n\n### Popout\n\nUsing whatever data set you choose (it need not be the same data used for Figures 1-6... you get the idea), create a visualization called Figure 7 that effectively uses the concept of popout. Write a caption that explains your choices of marks and channels in these terms. Then, using the exact same data, create a visualization called Figure 8 that makes the identification task in Figure 7 much more difficult. Write a caption that explains why Figure 8 sucks compared to Figure 7.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}