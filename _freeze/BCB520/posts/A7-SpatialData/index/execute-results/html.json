{
  "hash": "b4251178e6252e1dcaa6aeebc18cdaba",
  "result": {
    "markdown": "---\ntitle: \"Practice with Spatial Data\"\nsubtitle: \"Malaria, Ocean Currents, Baseball...\"\nformat:\n  html:\n    toc: false\n    echo: true\nauthor: \"Barrie Robison\"\ndate: \"2023-04-10\"\ncategories: [Portfolio, DataViz, Spatial, GGPlot, Assignment]\nimage: \"Rlyeh.png\"\ndescription: \"Maps and Spatial Fields are fun!\"\ncode-fold: true\ncode-tools: true\n---\n\n\n## OVERVIEW\n\nIn this assignment, we'll consider some of the tools and techniques for visualizing spatial data. Spatial data comes in two broad categories, geographic and spatial fields. Let's practice a few visualizations to get a feel for how these things work!\n\n## GEOGRAPHIC MAPS!\n\nIn class I bet Ronald that he would end up creating some kind of map based visualization before he graduated with his PHD. This is because he works on Malaria - a terrible disease with a strong spatial component to its risk levels. Let's get some Malaria data and map it!\n\nThe data I obtained were from the [Malaria Atlas](https://data.malariaatlas.org/trends?year=2020&metricGroup=Malaria&geographicLevel=admin0&metricSubcategory=Pf&metricType=rate&metricName=incidence). I downloaded a csv for 10 years of data for all the countries the had on file.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(dplyr)\n\nMalaria <- read.csv(\"National_Unit_data.csv\")\n\nIncidence<- Malaria%>%\n  filter(Metric == \"Infection Prevalence\" & Year == \"2019\")%>%\n  mutate(Prevalence = Value)%>%\n  select(c(ISO3, Prevalence))\n```\n:::\n\n\nNow I'm going to use the `rnaturalearth` package to create contry polygons. Then I'll add the Malaria data to that data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nworld_map <- ne_countries(scale = \"medium\", returnclass = \"sf\")\n\nmap_data <- world_map %>%\n  left_join(Incidence, by = c(\"iso_a3\" = \"ISO3\"))\n```\n:::\n\n\nNow I will make a plot!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = map_data, aes(fill = Prevalence)) +\n  scale_fill_gradient(low = \"white\", high = \"red\", na.value = \"gray\", name = \"Malaria Prevalence\") +\n  theme_minimal() +\n  theme(axis.text = element_blank(), axis.ticks = element_blank(), axis.title = element_blank()) +\n  labs(title = \"Malaria Prevalence by Country\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nOh SNAP! We made a MAP!\n\nHey! That rhymes!\n\nWhat is missing? Units? Is that actually prevalence? We sure left a lot of data on the table? Can we add some kind of time thing? Change the variable?\n\n## SPATIAL FIELDS\n\nSpatial field data refers to data that has a continuous spatial distribution and can be measured at any location within the defined area. Here are some interesting examples of spatial field data:\n\n1.  Air temperature: Air temperature data collected from weather stations or remote sensing technologies can be used to create temperature maps or to study climate change, urban heat islands, and other environmental phenomena. [TROPICAL CYCLONE!](https://svs.gsfc.nasa.gov/14312)\n\n2.  Precipitation: Rainfall, snowfall, or other forms of precipitation data collected from weather stations or satellites can be used to study the hydrological cycle, flood risk, droughts, or water resource management.\n\n3.  Soil moisture: Soil moisture data collected from in situ sensors or remote sensing technologies can be used to study agricultural productivity, irrigation management, droughts, and land degradation. Elevation data (Digital Elevation Models, DEMs):\n\n4.  Elevation data collected from satellite-based radar, LiDAR, or photogrammetry can be used to study topography, watershed delineation, flood risk, landslides, or geomorphology.\n\n5.  Vegetation indices: Indices like the Normalized Difference Vegetation Index (NDVI) or Enhanced Vegetation Index (EVI) derived from satellite imagery can be used to study vegetation health, land cover change, deforestation, agricultural productivity, and carbon sequestration.\n\n6.  Air quality: Data on air pollutants like PM2.5, PM10, NO2, SO2, O3, and CO collected from ground-based monitors or satellites can be used to study the impact of pollution on human health, urban planning, or environmental policy.\n\n7.  Oceanographic data: Sea surface temperature, salinity, and chlorophyll-a concentration data collected from buoys, ships, or satellites can be used to study ocean currents, climate change, or marine ecosystems. [OCEAN CURRENTS!](https://earth.nullschool.net/#current/ocean/surface/currents/orthographic=-177.96,0.40,1571)\n\n8.  Population density: Spatially explicit population density data can be used to study urbanization, migration patterns, infrastructure planning, or public health.\n\n9.  Land use and land cover: Land use and land cover data collected from satellite imagery can be used to study urban growth, deforestation, habitat fragmentation, or landscape ecology.\n\n10. Seismic activity: Spatial distribution of earthquakes and their magnitudes can be used to study tectonics, fault zones, seismic hazards, or infrastructure resilience. [DARK NIGHTS IN ANTAKYA](https://svs.gsfc.nasa.gov/31224)\n\n11.  SPORTS!  Let's check out a baseball example!\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"baseballr\")\nlibrary(remotes)\n\n\n# install_github(\"bayesball/CalledStrike\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(CalledStrike)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: shiny\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: baseballr\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: mgcv\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: nlme\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'nlme'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    collapse\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is mgcv 1.8-41. For overview type 'help(\"mgcv-package\")'.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: metR\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'metR'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    cross\n```\n:::\n\n```{.r .cell-code}\n#ShinyDemo()\n```\n:::\n\n\nThis example is the Pitch_Locations example from [byaesball's CalledStrike Github Repository](https://github.com/bayesball/CalledStrike/tree/master/vignettes)\n\n#### Introduction\n\nThere are three functions for visualizing pitch locations.\n\n- The function ```location_compare()``` will graph the pitch location for a data frame or list of data frames.\n\n- The function ```location_count()``` will show the locations of pitches for a specific pitcher on a particular count.\n\n- The function ```location_count_compare()``` will graph the pitch locations for a specific pitcher for several values of the count.\n\n#### Data\n\nThe package includes the dataset sc_pitchers_2019 that contains Statcast data for 20 pitchers for the 2019 season.\n\n#### Pitch Locations for a List\n\nSuppose we want to compare the locations of the fastballs thrown by Aaron Nola and Trevor Bauer.  \n\nI find the subset of data I need and then create a list dividing the data by pitcher.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- filter(sc_pitchers_2019, \n            pitcher %in% c(605400, 545333),\n            pitch_type == \"FF\")\nds <- split(d, d$pitcher)\nnames(ds) <- c(\"Bauer\", \"Nola\")\n```\n:::\n\n\nNow we can construct the graph.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlocation_compare(ds)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 22 rows containing non-finite values\n(`stat_density2d_filled()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n#### Pitch Locations for a Specific Count\n\nSuppose we want to look at the locations of Aaron Nola’s pitches on a 0-0 count. I can find Nola’s MLBAM id number by use of the chadwick dataset (also included in the package) that contains the id numbers for all players.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchadwick %>% \n  filter(name_last == \"Nola\", name_first == \"Aaron\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  name_first name_last key_mlbam\n1      Aaron      Nola    605400\n```\n:::\n:::\n\n\nTo produce the graph, type\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlocation_count(sc_pitchers_2019, \n               605400, \"Aaron Nola\", \"0-0\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing non-finite values\n(`stat_density2d_filled()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n#### Pitch Locations Across a Group of Counts\n\nSuppose we want to compare Nola's pitch locations across the counts \"0-0\", \"1-0\", \"0-1\", \"0-2\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlocation_count_compare(sc_pitchers_2019, \n               605400, \"Aaron Nola\", \n               \"R\", \"Offspeed\", \n               c(\"0-0\", \"1-0\", \"0-1\", \"0-2\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing non-finite values\n(`stat_density2d_filled()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nEND\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}