{
  "hash": "d9b314e6ad6c7d1bd33baeafc42e4b70",
  "result": {
    "markdown": "---\ntitle: \"Embedding Data Literacy Content in Project TwinStick\"\nsubtitle: \"1 - Single Generation Graphs\"\ndescription: \"How can we embed Data Literacy exercises for the early game?\"\nauthor: \"Barrie D. Robison\"\ndate: \"August 17, 2023\"\ncategories: [TwinStick, Evolution, Data Science]\ncode-fold: true  \ncode-tools: true\n---\n\n\nIs it really an *Evolutionary* game?\n\nWhen we are developing our games, we perform extensive testing to make sure the underlying biological models are performing as expected. In the case of evolutionary games, we need to test that the population of enemies is indeed adapting the game conditions as we intended. This post is (I hope) the first in a series in which we document those tests.\n\nMy hope is that performing these tests in this format will serve as an organized archive of our analyses, improving reproducibility and rigor. I also have a vain glimmer of hope that some person other than me might actually be interested in this topic.\n\n## PROJECT TWIN STICK\n\nThis is intended to be an evolutionary shooter. The game is described in detail [here](https://professorpolymorphic.github.io/PolymorphicWeb/Games/TwinStick/).\n\n## DATA\n\nIn this section, we ingest the data from whatever runs are relevant to the analysis. The data are written from the project in `.csv` files. The following code reads all `.csv` files from the working directory. It creates new variables for the source file name (`file`) and the number of offspring produced by each individual (`offspring_count`). It then appends all the data files into a single data frame called `allfiles`. I also create a few aggregations of the data by generating mean values of interest (traits, genes, fitness estimates) for each generation in each file (`TraitAvg`, `GeneAvg`, `FitAvg`)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(pheatmap)\n\n\nfiles <- list.files(pattern = \"*.csv\", full.names = TRUE)\n\nallfiles = data.frame()\nfor(csv in files){\n  Twin3 <- read.csv(csv, as.is=T, header=T)\n  Twin3['file'] = csv\n\n\nTwin3<-Twin3%>%\n  mutate(Unique.Slime.ID = paste(Wave.Number, \".\", Slime.ID))%>%\n  mutate(Unique.Parent.One = paste(Wave.Number-1, \".\", Parent.One))%>%\n  mutate(Unique.Parent.Two = paste(Wave.Number-1, \".\", Parent.Two))\n\n\ndf_parents <- Twin3 %>%\n  select(Unique.Parent.One, Unique.Parent.Two) %>%\n  pivot_longer(cols = everything(), names_to = \"parent_type\", values_to = \"parent_id\")\n\n# Count the number of offspring for each parent\noffspring_counts <- df_parents %>%\n  group_by(parent_id) %>%\n  summarise(offspring_count = n(), .groups = \"drop\")\n\noffspring_counts <- offspring_counts%>%\n  filter(parent_id != \"-1 . N/A\")\n\n\noffspring_counts<- rename(offspring_counts, Unique.Slime.ID = parent_id)\n\n\n\nTwin3 <- Twin3 %>%\n  left_join(offspring_counts, by = \"Unique.Slime.ID\")%>%\n  replace_na(list(offspring_count = 0))\n\nallfiles<-rbind(allfiles,Twin3)\n\n}\n\n\n\nTraits <- c(\"Main.Resistance.Trait\", \"Secondary.Resistance.Trait\", \"Speed.Trait\",\n           \"Tower.Attraction.Trait\", \"Slime.Optimal.Distance.Trait\", \"Turn.Rate.Trait\", \n           \"Slime.View.Range.Trait\", \"Tower.View.Range.Trait\")\n\nGenes <- c(\"Main.Resistance.Gene\", \"Secondary.Resistance.Gene\", \"Speed.Gene\",\n           \"Tower.Attraction.Gene\", \"Slime.Optimal.Distance.Gene\", \"Turn.Rate.Gene\", \n           \"Slime.View.Range.Gene\", \"Tower.View.Range.Gene\")\n\nallfiles<-allfiles%>%\n  mutate(Generation=as.factor(Wave.Number))%>%\n  mutate(offspring.count.Fitness = offspring_count)%>%\n  mutate(reproduce = if_else(offspring_count == 0, \"N\", \"Y\"))\n   \n\nTraitAvg <- allfiles %>%\n  group_by(file, Generation) %>%\n  summarize(across(ends_with(\"Trait\"), mean,  na.rm = TRUE))\n\nGeneAvg <- allfiles %>%\n  group_by(file, Generation) %>%\n  summarize(across(ends_with(\"Gene\"), list(mean = mean, var = var), na.rm = TRUE, .names = \"{.fn}.{.col}\"))\n\nFitAvg <- allfiles %>%\n  group_by(file, Generation) %>%\n  summarize(across(ends_with(\"Fitness\"), list(mean = mean, var = var), na.rm = TRUE, .names = \"{.fn}.{.col}\"))\n\n\nallfiles <- allfiles %>%\n  mutate(LResist.Trait = case_when(\n    Main.Type == \"Lightning\" & Secondary.Type == \"Lightning\" ~ 1.0,\n    Main.Type == \"Lightning\" & Secondary.Type != \"Lightning\" ~ 0.6,\n    Main.Type != \"Lightning\" & Secondary.Type == \"Lightning\" ~ 0.4,\n    TRUE ~ 0\n  ))\n```\n:::\n\n\nThe `allfiles` dataframe contains the following variables (I also show a few columns of the example data):\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata.dictionary <- t(as.data.frame(head(allfiles)))\nknitr::kable(data.dictionary)\n```\n\n::: {.cell-output-display}\n|                             |1                                      |2                                      |3                                      |4                                      |5                                      |6                                      |\n|:----------------------------|:--------------------------------------|:--------------------------------------|:--------------------------------------|:--------------------------------------|:--------------------------------------|:--------------------------------------|\n|Slime.ID                     |0                                      |1                                      |2                                      |3                                      |4                                      |5                                      |\n|Wave.Number                  |0                                      |0                                      |0                                      |0                                      |0                                      |0                                      |\n|Path.Distance.To.Player      |11.11780                               |51.38884                               |54.21675                               |53.52212                               |53.59597                               |45.62690                               |\n|Player.Distance.Fitness      |4126.1610                              |954.4017                               |905.5223                               |917.0590                               |915.8185                               |1072.3420                              |\n|Parent.One                   |N/A                                    |N/A                                    |N/A                                    |N/A                                    |N/A                                    |N/A                                    |\n|Parent.Two                   |N/A                                    |N/A                                    |N/A                                    |N/A                                    |N/A                                    |N/A                                    |\n|Main.Type                    |Fire                                   |Player                                 |Fire                                   |Player                                 |Lightning                              |Ice                                    |\n|Secondary.Type               |Lightning                              |Balanced                               |Lightning                              |Balanced                               |Laser                                  |Lightning                              |\n|Main.Resistance.Gene         |2.0608870                              |-4.4758530                             |-4.4736510                             |-0.2062796                             |0.7103590                              |-1.3259160                             |\n|Main.Resistance.Trait        |0.5781593                              |0.2109908                              |0.2110825                              |0.4374371                              |0.4943977                              |0.3701721                              |\n|Secondary.Resistance.Gene    |0.01938968                             |0.62744310                             |0.69598620                             |0.89974080                             |-2.50028000                            |5.43153300                             |\n|Secondary.Resistance.Trait   |0.1831496                              |0.2069943                              |0.2098212                              |0.2183915                              |0.1066839                              |0.4645305                              |\n|Slime.View.Range.Gene        |1.45217100                             |1.50213300                             |1.37864100                             |0.08060846                             |-1.77270500                            |-2.11503800                            |\n|Slime.View.Range.Trait       |9.846652                               |9.891931                               |9.779832                               |8.575567                               |6.864766                               |6.562094                               |\n|Tower.View.Range.Gene        |0.7422258                              |-2.2926750                             |0.5915011                              |-1.4378940                             |1.7216920                              |-0.2360138                             |\n|Tower.View.Range.Trait       |22.85026                               |15.42024                               |22.47606                               |17.44348                               |25.23899                               |20.41014                               |\n|Player.View.Range.Gene       |-0.7063282                             |-1.7676410                             |-1.2759830                             |-2.7530170                             |1.3304860                              |-2.3889850                             |\n|Player.View.Range.Trait      |3.356673                               |2.912497                               |3.109854                               |2.560056                               |4.390841                               |2.683669                               |\n|Wall.View.Range.Gene         |0.1313843                              |-0.1305148                             |0.0166637                              |-2.3788810                             |2.7195210                              |-1.0645380                             |\n|Wall.View.Range.Trait        |5.131722                               |4.938622                               |5.046419                               |3.530812                               |7.309699                               |4.298796                               |\n|Sheep.View.Range.Gene        |1.7711210                              |1.5496080                              |2.7501400                              |-2.0088600                             |0.1356484                              |-1.8824000                             |\n|Sheep.View.Range.Trait       |6.462865                               |6.272002                               |7.337697                               |3.731431                               |5.134914                               |3.802772                               |\n|Slime.Attraction.Gene        |-0.9736148                             |-0.2611402                             |1.1806460                              |-2.3092990                             |2.6089730                              |-2.2889140                             |\n|Slime.Attraction.Trait       |0.4394477                              |0.4836845                              |0.5732593                              |0.3595484                              |0.6575158                              |0.3607228                              |\n|Tower.Attraction.Gene        |-0.4425031                             |0.1107965                              |-6.3629560                             |2.1391270                              |1.3166820                              |3.1351720                              |\n|Tower.Attraction.Trait       |-0.29616710                            |-0.23185630                            |-0.77999960                            |0.01738906                             |-0.08520758                            |0.14095180                             |\n|Player.Attraction.Gene       |-0.682144100                           |-0.007417813                           |3.359316000                            |-1.138752000                           |-3.313859000                           |2.257708000                            |\n|Player.Attraction.Trait      |0.01473093                             |0.09874988                             |0.47763400                             |-0.04231870                            |-0.30428250                            |0.36462820                             |\n|Wall.Attraction.Gene         |0.11956880                             |-0.57143210                            |-0.49371080                            |-0.95780370                            |2.63732400                             |0.07642503                             |\n|Wall.Attraction.Trait        |-0.8776227                             |-0.8949995                             |-0.8931594                             |-0.9037367                             |-0.7926000                             |-0.8787764                             |\n|Sheep.Attraction.Gene        |0.8572116                              |-1.4152040                             |-3.5675310                             |1.0647060                              |4.1666570                              |1.2193660                              |\n|Sheep.Attraction.Trait       |0.7710594                              |0.6561534                              |0.5270030                              |0.7800875                              |0.8851026                              |0.7866486                              |\n|Slime.Optimal.Distance.Gene  |0.2664202                              |-1.7590030                             |-3.1496450                             |0.4679058                              |-0.4069065                             |0.4513546                              |\n|Slime.Optimal.Distance.Trait |0.27595890                             |0.03011549                             |-0.14272460                            |0.29906120                             |0.19654550                             |0.29717610                             |\n|Speed.Gene                   |2.670809                               |1.419246                               |2.097860                               |-1.671494                              |-1.217723                              |-1.739751                              |\n|Speed.Trait                  |3.594294                               |3.057428                               |3.342277                               |1.973656                               |2.109971                               |1.953825                               |\n|Turn.Rate.Gene               |-2.0039470                             |0.9699734                              |0.2064506                              |-4.7445310                             |-0.2931280                             |0.6523061                              |\n|Turn.Rate.Trait              |0.1190994                              |0.2214034                              |0.1902499                              |0.0637966                              |0.1717490                              |0.2080165                              |\n|Sprint.Duration.Gene         |0.3580502                              |-3.5267780                             |-2.8798950                             |-1.8273190                             |1.3285910                              |5.9572890                              |\n|Sprint.Duration.Trait        |2.611816                               |1.464134                               |1.636994                               |1.938691                               |2.911409                               |4.079883                               |\n|Sprint.Cooldown.Gene         |0.1790418                              |4.8556380                              |1.3212770                              |-2.8306380                             |-3.1959230                             |2.3105360                              |\n|Sprint.Cooldown.Trait        |2.7232060                              |4.9613790                              |3.9469710                              |0.2784542                              |0.1965971                              |4.5487290                              |\n|X                            |NA                                     |NA                                     |NA                                     |NA                                     |NA                                     |NA                                     |\n|file                         |./geneWriteFile08_11_2023_01-36-07.csv |./geneWriteFile08_11_2023_01-36-07.csv |./geneWriteFile08_11_2023_01-36-07.csv |./geneWriteFile08_11_2023_01-36-07.csv |./geneWriteFile08_11_2023_01-36-07.csv |./geneWriteFile08_11_2023_01-36-07.csv |\n|Unique.Slime.ID              |0 . 0                                  |0 . 1                                  |0 . 2                                  |0 . 3                                  |0 . 4                                  |0 . 5                                  |\n|Unique.Parent.One            |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |\n|Unique.Parent.Two            |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |-1 . N/A                               |\n|offspring_count              |0                                      |0                                      |0                                      |0                                      |0                                      |0                                      |\n|Generation                   |0                                      |0                                      |0                                      |0                                      |0                                      |0                                      |\n|offspring.count.Fitness      |0                                      |0                                      |0                                      |0                                      |0                                      |0                                      |\n|reproduce                    |N                                      |N                                      |N                                      |N                                      |N                                      |N                                      |\n|LResist.Trait                |0.4                                    |0.0                                    |0.4                                    |0.0                                    |0.6                                    |0.4                                    |\n:::\n:::\n\n\nVariables that end in `.Gene` are the values of the genome for that particular locus. Variables that end in `.Trait` are the values of the trait for that particular locus. Variables that end in `.Fitness` are the values of that particular Fitness component.\n\n## EXPERIMENTAL CONDITIONS\n\nIn this situation, I'm interested in what types of Data Literacy exercises I can incorporate between generations of the game, especially in the first few generations. We often show players time series graphs of trait values over time, but these don't tend to make much sense until 5 to 10 generations have occurred.\n\nHere, I'm going to explore some visualizations that summarize what happened in the generation that the player most recently completed.\n\n## RESULTS\n\n### Slime Types\n\nEach Slime has a `Main.Type` and a `Secondary.Type`. These types use the `~.Resistance.~` category to confer resistance to the appropriate damage type.\n\nThe following code creates two summary dataframes with the suffix `~Typecounts` that count the number of slimes of each `~.Type` in each generation for each replicate. It then creates the graphs of `~Type` frequency over time.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMainTypecounts <- allfiles %>%\n  group_by(Main.Type, Generation, file) %>%\n  summarise(Main.count = n(), .groups = \"drop\")\n\nSecondaryTypecounts <- allfiles %>%\n  group_by(Secondary.Type, Generation, file) %>%\n  summarise(Secondary.count = n(), .groups = \"drop\")\n\n            \n\nggplot(MainTypecounts, aes(x = Generation, y = Main.count, fill = as.factor(Main.Type))) +\n  geom_col(position = \"stack\") +\n  labs(x = \"Generation\", y = \"Count\", fill = \"Main Slime Type\") +\n  theme_minimal()+\n  facet_wrap(~file, ncol=2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(SecondaryTypecounts, aes(x = Generation, y = Secondary.count, fill = as.factor(Secondary.Type))) +\n  geom_col(position = \"stack\") +\n  labs(x = \"Generation\", y = \"Count\", fill = \"Secondary Slime Type\") +\n  theme_minimal()+\n  facet_wrap(~file, ncol=2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n## GENERATION 0\n\nYou've defeated the first generation of slimes! Our sensors indicate that the slimes have different types, that we've named Fire, Player, Lightning, Ice, Laser, Acid, Balanced, Blaster.\n\nHere is a graph showing the frequencies of the slime types in the wave you just defeated.\n\n\n::: {.cell layout-ncol=\"1\"}\n\n```{.r .cell-code}\nslime_palette <- c(\"green\", \"grey\", \"darkred\", \"red\", \"blue\", \"purple\", \"lightgreen\",\"black\")\n\nggplot(MainTypecounts%>%\n         filter(Generation==0), aes(x=Main.Type, y = Main.count, fill = Main.Type))+\n  geom_col()+\n  scale_fill_manual(values = slime_palette) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Frequency of slime type (Main.Type) in the previous wave.](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nLet's test your data skills! Based on this graph, what was the most common slime type in the most recent wave?\n\nGreat job! I wonder if these slime types have any special characteristics that would affect your strategy?\n\n## GENERATION 1\n\nWell done again! You've survived another wave of slime attacks. We are collecting more data on these mysterious creatures.\n\nIt looks like each wave of slimes is actually the offspring of the previous wave! Our sensors are able to detect the number of offspring that each slime you just defeated will have. Check this out! Here is graph that summarizes the distribution of the number of offspring.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(allfiles%>%\n         filter(Generation == 1),\n       aes(x = offspring_count)) +\n  geom_histogram(binwidth = 1, fill = \"blue\", color = \"black\", alpha = 0.7) +\n  labs(title = \"Histogram of Offspring Count\",\n       x = \"Number of Offspring\",\n       y = \"Count\") +\n  theme_minimal()+ \n  scale_y_continuous(breaks = seq(0, 150, by = 10),   \n                     minor_breaks = seq(0, 150, by = 1))+\n  scale_x_continuous(breaks = seq(0, 100, by = 10),   \n                     minor_breaks = seq(0, 100, by = 1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nBest <- allfiles%>%\n  filter(Generation==1)\n```\n:::\n\n\nHow many slimes do you think will contribute NO offspring to the next wave?\n\nSomething to think about: There are a couple slimes that had LOTS of offspring, and one that even had 85 offspring! What made them so special? Why were they able to have so many offspring?\n\n## GENERATION 2\n\nThat was close! Let's analyze what is going on! We think we've figured out what can explain the difference in the number of offspring! It looks like the slime that get closest to the player tend to have the most babies! Check this out!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(allfiles%>%\n         filter(Generation ==2),\n       aes(x=Path.Distance.To.Player, y=offspring_count))+\n  geom_point(aes(color=Main.Type))+\n  labs(title = \"Number of Offspring is related to Player Distance\",\n       x = \"Closest distance from player\",\n       y = \"Number of Offspring\") +\n  theme_minimal()+ \n  scale_y_continuous(breaks = seq(0, 100, by = 10),   \n                     minor_breaks = seq(0, 100, by = 1))+\n  scale_x_continuous(breaks = seq(0, 100, by = 10),   \n                     minor_breaks = seq(0, 100, by = 1))+\n  scale_color_manual(values = slime_palette)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nNote that these graphs are interactive! You can get all sorts of information from them by hovering or clicking on them! Try to use that approach to figure out the Slime Type of the slime that had the MOST offspring! Was it the same slime that got closest to the player?\n\n## GENERATION 3\n\nHow are those pesky slimes getting close to you? Let's look at some of the traits that might explain how they are getting through your defenses.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMainTypecounts <- allfiles %>%\n  group_by(Main.Type, Generation, Wave.Number, file) %>%\n  summarise(Main.count = n(), .groups = \"drop\")\n\nSecondaryTypecounts <- allfiles %>%\n  group_by(Secondary.Type, Generation, Wave.Number, file) %>%\n  summarise(Secondary.count = n(), .groups = \"drop\")\n\n            \n\nggplot(MainTypecounts%>%\n         filter(Wave.Number<4), aes(x = Generation, y = Main.count, fill = as.factor(Main.Type))) +\n  geom_col(position = \"stack\") +\n  labs(x = \"Generation\", y = \"Count\", fill = \"Main Slime Type\") +\n  theme_minimal()+\n  facet_wrap(~file, ncol=2)+\n  scale_fill_manual(values = slime_palette)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(MainTypecounts%>%\n         filter(Wave.Number<4), aes(x = Generation, y = Main.count, color = as.factor(Main.Type))) +\n  geom_line(aes(group=Main.Type)) +\n  labs(x = \"Generation\", y = \"Count\", fill = \"Main Slime Type\") +\n  theme_minimal()+\n  facet_wrap(~file, ncol=2)+\n  scale_color_manual(values = slime_palette)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(SecondaryTypecounts%>%\n         filter(Wave.Number<4), aes(x = Generation, y = Secondary.count, fill = as.factor(Secondary.Type))) +\n  geom_col(position = \"stack\") +\n  labs(x = \"Generation\", y = \"Count\", fill = \"Secondary Slime Type\") +\n  theme_minimal()+\n  facet_wrap(~file, ncol=2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n:::\n\n\nThese graphs will help you understand how the population of slimes is changing over time in response to your defenses.\n\nWhat type of slime is the most common in the last generation?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(allfiles%>%\n         filter(Generation == 4),\n       aes(x = Main.Type, y = offspring_count)) +\n  geom_jitter(aes(color = Main.Type), width = 0.3, height = 0) +\n  facet_wrap(~file) +\n  scale_color_manual(values = slime_palette) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nFitAvgType <- allfiles%>%\n  group_by(file, Generation, Wave.Number, Main.Type) %>%\n  summarize(across(ends_with(\"Fitness\"), list(mean = mean, var = var, sum = sum), na.rm = TRUE, .names = \"{.fn}.{.col}\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'file', 'Generation', 'Wave.Number'. You\ncan override using the `.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nggplot(FitAvgType%>%\n         filter(Generation == 4),\n       aes(x= Main.Type, y = sum.offspring.count.Fitness))+\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_sorted <- allfiles %>%\n    filter(Generation == 4) %>%\n    arrange(offspring_count) %>%\n    mutate(Unique.Slime.ID = factor(Unique.Slime.ID, levels = Unique.Slime.ID),\n           cumulative_offspring = cumsum(offspring_count),\n           # Create discrete bins for cumulative_offspring with labels\n           cumulative_bins = cut(cumulative_offspring, \n                                 breaks = quantile(cumulative_offspring, \n                                                  probs = c(0.5,0.9, 0.95, 1)),\n                                 labels = c(\"Low\", \"Medium\", \"High\")))\n\n\nggplot(df_sorted, aes(x = Unique.Slime.ID, y = offspring_count)) +\n    geom_col(aes(fill = Main.Type)) +\n    labs(title = \"Column Plot of Offspring Count\",\n         x = \"Slimes\",\n         y = \"Number of Offspring\") +\n    theme_minimal() +\n    facet_wrap(~file) +\n    scale_fill_brewer(palette = \"Set1\")+\n  theme(axis.text.x = element_blank())+\n  scale_fill_manual(values = slime_palette)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nScale for fill is already present.\nAdding another scale for fill, which will replace the existing scale.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## Slime Fitness\n\nIn most cases, it is useful to summarize the behavior of the fitness function for each experiment. In this case, the fitness function calculates a value of 50,000/(distance to player +1). I will also reverse calculate that for visualization, showing the actual distance to the player (`Path.Distance.To.Player`). We then use Roulette Wheel selection to determine the parents of the next generation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(allfiles, aes(x=Wave.Number, y= Path.Distance.To.Player))+\n  geom_jitter(aes(x=Wave.Number, y= Path.Distance.To.Player, color = offspring_count, alpha = offspring_count))+\n  geom_smooth()+\n  facet_wrap(~file, ncol = 2)+\n  scale_color_continuous(low=\"blue\", high = \"red\")+\n  ylim(0, 80)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'gam' and formula = 'y ~ s(x, bs = \"cs\")'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Computation failed in `stat_smooth()`\nCaused by error in `smooth.construct.cr.smooth.spec()`:\n! x has insufficient unique values to support 10 knots: reduce k.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 227 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndf_sorted <- allfiles %>%\n    filter(Generation == 2) %>%\n    arrange(offspring_count) %>%\n    mutate(Unique.Slime.ID = factor(Unique.Slime.ID, levels = Unique.Slime.ID),\n           cumulative_offspring = cumsum(offspring_count),\n           # Create discrete bins for cumulative_offspring with labels\n           cumulative_bins = cut(cumulative_offspring, \n                                 breaks = quantile(cumulative_offspring, \n                                                  probs = c(0.5,0.9, 0.95, 1)),\n                                 labels = c(\"Low\", \"Medium\", \"High\")))\n\n\nggplot(df_sorted, aes(x = Unique.Slime.ID, y = offspring_count)) +\n    geom_col(aes(fill = cumulative_bins)) +\n  geom_line(aes(x=Unique.Slime.ID, y = cumulative_offspring, group = 1))+\n    labs(title = \"Column Plot of Offspring Count\",\n         x = \"Slime ID\",\n         y = \"Number of Offspring\") +\n    theme_minimal() +\n    facet_wrap(~file) +\n    scale_fill_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(df_sorted, aes(x = Unique.Slime.ID, y = cumulative_offspring)) +\n    geom_col(aes(fill = cumulative_bins)) +\n    labs(title = \"Column Plot of Offspring Count\",\n         x = \"Slime ID\",\n         y = \"Number of Offspring\") +\n    theme_minimal() +\n    facet_wrap(~file) +\n    scale_fill_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n:::\n\n\nthese plots might be useful as a starting point. The ideas would be to show the player that not all slimes have the same number of babies. Then we would challenge them as to why that is happening.\n\nThe next step would be to show them that the number of babies is related to the fitness function of the game. In this case that is how close they get to the player.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df_sorted, aes(x = Unique.Slime.ID, y = Path.Distance.To.Player)) +\n    geom_col(aes(fill = offspring_count)) +\n    labs(title = \"Column Plot of Path Distance to Player\",\n         x = \"Slime ID\",\n         y = \"Path Distance to Player\") +\n    theme_minimal() +\n    facet_wrap(~file) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(df_sorted, aes(x = Path.Distance.To.Player)) +\n  geom_histogram(binwidth = 1, fill = \"blue\", color = \"black\", alpha = 0.7) +\n  labs(title = \"Histogram of Path Distance to Player\",\n       x = \"Path Distance to Player\",\n       y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(df_sorted, aes(x=Path.Distance.To.Player, y= offspring_count))+\n  geom_point(aes(color = cumulative_offspring))+\n  scale_colour_gradient(low = \"blue\", high = \"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(df_sorted, aes(x=Player.Distance.Fitness, y= offspring_count))+\n  geom_point(aes(color = cumulative_offspring))+\n  scale_colour_gradient(low = \"blue\", high = \"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-4.png){width=672}\n:::\n:::\n\n\nSo the closer they get to the player, the more babies they have.\n\nNext, we have to figure out what traits might explain how they are getting so close!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nslime_palette <- c(\"green\", \"grey\", \"darkred\", \"red\", \"blue\", \"purple\", \"lightgreen\",\"black\")\n\n# Assuming df_sorted is your data frame\nggplot(df_sorted, aes(x = Main.Type, y = offspring_count)) +\n  geom_jitter(aes(color = Main.Type), width = 0.3, height = 0) +\n  facet_wrap(~file) +\n  scale_color_manual(values = slime_palette) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(df_sorted, aes(x = Secondary.Type, y = offspring_count)) +\n  geom_jitter(aes(color = Secondary.Type), width = 0.3, height = 0) +\n  facet_wrap(~file) +\n  scale_color_manual(values = slime_palette) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n:::\n\n\nThis would be for slime type. What about the traits?\n\n## Evolutionary Responses\n\nTo estimate what traits might be under selection, we can calculate selection gradients for each trait. This is essentially the slope of the line between `offspring_count` and the Trait.\n\nFor each Trait, we should also try to understand its individual evolutionary trajectory. Is the population mean for the trait increasing or decreasing?\n\nSince the first thing we are interested in is Damage Resistance conferred by Type, we'll calculate Lightning resistance directly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallfiles <- allfiles %>%\n  mutate(LResist.Trait = case_when(\n    Main.Type == \"Lightning\" & Secondary.Type == \"Lightning\" ~ 1.0,\n    Main.Type == \"Lightning\" & Secondary.Type != \"Lightning\" ~ 0.6,\n    Main.Type != \"Lightning\" & Secondary.Type == \"Lightning\" ~ 0.4,\n    TRUE ~ 0\n  ))\n\ntraittemp <- allfiles %>%\n  select(Generation, offspring_count, file, LResist.Trait) %>%\n  group_by(Generation, file) %>%\n  mutate(scaleST0 = as.vector(scale(LResist.Trait, center = TRUE))) %>%\n  mutate(scaleST02 = scaleST0 * scaleST0) %>%\n  mutate(Generation = as.numeric(as.character(Generation)))\n\n\n\n\nGradients <- traittemp %>%\n  group_by(Generation, file) %>%\n  do({\n    model <- lm(offspring_count ~ scaleST0 + scaleST02, data = .)\n    data.frame(\n      Beta = coefficients(model)[2],\n      PB = summary(model)$coef[2, 4],\n      Trait = \"LResist.Trait\"\n    )\n  })\n\nGradients <- Gradients %>%\n  mutate(sig = if_else(PB < 0.05 , \"Y\", \"N\"))\n\nTraitAvg <- allfiles %>%\n  group_by(file, Generation) %>%\n  summarize(across(ends_with(\"Trait\"), mean,  na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'file'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\ndf_Gen <- allfiles %>%\n  filter(Generation == 2)\n  \n  \n\nggplot(data = df_Gen, aes(x=LResist.Trait, y = offspring_count))+\n  geom_jitter()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = TraitAvg, aes(x = as.numeric(Generation), y = LResist.Trait))+\n    geom_smooth(data = TraitAvg, aes(x = as.numeric(Generation), y = LResist.Trait), method = \"loess\") +\n    theme(legend.position = \"none\") +\n    facet_wrap(~file, ncol = 2) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(Gradients, aes(x=Generation, y = Beta))+\n  geom_point(aes(color = sig))+\n  geom_smooth(fill=\"blue\")+\n  scale_color_manual(values = c(\"grey\",\"red\"))+\n  geom_hline(yintercept=0, linetype=\"dashed\", color = \"black\")+\n  theme(legend.position = \"none\",\n        panel.background = element_blank())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-3.png){width=672}\n:::\n:::\n\n\nNow we'll perform a similar analysis for the remaining traits.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGradientslong <- data.frame()\nfor(i in seq_along(Traits)){\n\ntraittemp<-allfiles%>%\n  select(Generation, offspring_count, file, !!sym(Traits[i]))%>%\n  group_by(Generation, file)%>%\n  mutate(scaleST0 = as.vector(scale(!!sym(Traits[i]), center = TRUE)))%>%\n  mutate(scaleST02 = scaleST0*scaleST0)%>%\n  mutate(Generation = as.numeric(as.character(Generation)))\n\nGradients <- traittemp %>%\n  group_by(Generation, file) %>%\n  do({\n    model <- lm(offspring_count ~ scaleST0 + scaleST02, data = .)\n    data.frame(\n      Beta = coefficients(model)[2],\n      PB = summary(model)$coef[2, 4],\n      Trait = Traits[i]\n    )\n  })\n\nGradients <- Gradients %>%\n  mutate(sig = if_else(PB < 0.05 , \"Y\", \"N\"))\n\nGradientslong <- rbind(Gradientslong, Gradients)\n\nG <- ggplot(data = GeneAvg, aes(x = as.numeric(Generation), y = !!sym(Genes[i])))+\n    geom_point(data = allfiles, aes(x = as.numeric(Generation), y = !!sym(Genes[i])), size=0.1, alpha = 0.02)+\n    geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y = !!sym(paste(\"mean.\",Genes[i], sep = \"\")), method = \"loess\")) +\n    theme(legend.position = \"none\") +\n    facet_wrap(~file, ncol = 2) \n\nP <- ggplot(data = TraitAvg, aes(x = as.numeric(Generation), y = !!sym(Traits[i])))+\n    geom_smooth(data = TraitAvg, aes(x = as.numeric(Generation), y = !!sym(Traits[i])), method = \"loess\") +\n    geom_point(data=allfiles, aes(x = as.numeric(Generation), y = !!sym(Traits[i]), color = offspring_count), size = 0.5, alpha =0.1)+\n    theme(legend.position = \"none\") +\n    facet_wrap(~file, ncol = 2) \n\n\n\nS <- ggplot(Gradients, aes(x=Generation, y = Beta))+\n  geom_point(aes(color = sig))+\n  geom_smooth(fill=\"blue\")+\n  scale_color_manual(values = c(\"grey\",\"red\"))+\n  geom_hline(yintercept=0, linetype=\"dashed\", color = \"black\")+\n  theme(legend.position = \"none\",\n        panel.background = element_blank())\n\nprint(G)\n\nprint(P)\n\nprint(S)\n\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-7.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-8.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-9.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-10.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-11.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-12.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-13.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-14.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-15.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-16.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-17.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-18.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-19.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-20.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_smooth(data = GeneAvg, aes(x = as.numeric(Generation), y =\n!!sym(paste(\"mean.\", : Ignoring unknown aesthetics: method\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-21.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-22.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-23.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-24.png){width=672}\n:::\n:::\n\n\n## Heatmap\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGradMatrix <- Gradientslong %>%\n  select(Generation, Trait, Beta)%>%\n  pivot_wider(names_from = Trait, values_from = Beta)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nAdding missing grouping variables: `file`\n```\n:::\n\n```{.r .cell-code}\npaletteLength <- 50\nmyColor <- colorRampPalette(c(\"blue\", \"white\", \"#ED2024\"))(paletteLength)\n# length(breaks) == length(paletteLength) + 1\n# use floor and ceiling to deal with even/odd length pallettelengths\n\n\nHeatmap <- GradMatrix %>%\n  ungroup()%>%\n  select(Main.Resistance.Trait, Secondary.Resistance.Trait, Slime.View.Range.Trait, \n         Tower.View.Range.Trait, \n         Tower.Attraction.Trait, Slime.Optimal.Distance.Trait, \n         Speed.Trait, Turn.Rate.Trait)\n\n\n\n\n\n\n\nHeatmatrix2 <- as.matrix(Heatmap)\n\nmyBreaks2 <- c(seq(min(Heatmatrix2), 0, length.out=ceiling(paletteLength/2) + 1), seq(max(Heatmatrix2)/paletteLength, max(Heatmatrix2), \n                                                                                      length.out=floor(paletteLength/2)))\n\n\nheatmap2 = pheatmap(Heatmatrix2,\n         cluster_rows = FALSE, # don't cluster rows\n         cluster_cols = TRUE, # don't cluster columns\n         clustering_distance_cols = \"euclidean\",\n         clustering_distance_rows = \"euclidean\",\n         clustering_method = \"complete\",\n         color = myColor,\n         breaks = myBreaks2)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## SINGLE GENERATION PLOTS\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsinglegen <- allfiles %>%\n  filter(Generation == 5)\n\nsinglegrad <- Gradientslong %>%\n  filter(Generation == 3)\n\n\nggplot(singlegen, aes(x=Speed.Trait) )+\n  geom_histogram()+\n  facet_grid(reproduce~file)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(singlegen, aes(x=Turn.Rate.Trait) )+\n  geom_histogram()+\n  facet_grid(reproduce~file)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(singlegen, aes(x=Turn.Rate.Trait, y = Speed.Trait, color = reproduce))+\n  geom_point()+\n  facet_wrap(~file)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-3.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}